<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LOVE Message Gacha</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #d4af37; --pink: #ffb6c1; --bg: #1a1a1a; --font: 'Zen Maru Gothic', sans-serif; }
        body { background: var(--bg); color: white; font-family: var(--font); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; }

        .title { margin-top: 20px; font-size: 1.1rem; color: var(--gold); text-align: center; font-weight: 700; }
        .title img { width: 30px; vertical-align: middle; margin-right: 8px; border-radius: 50%; border: 1px solid var(--gold); }

        #coin-display { margin-top: 15px; background: rgba(212, 175, 55, 0.2); padding: 8px 25px; border-radius: 30px; border: 2px solid var(--gold); color: var(--gold); font-weight: bold; font-size: 1.1rem; }

        #limit-info { margin-top: 15px; text-align: center; color: var(--pink); font-size: 0.85rem; background: rgba(255,182,193,0.1); padding: 15px; border-radius: 15px; width: 85%; max-width: 320px; border: 1px solid rgba(255,182,193,0.2); }
        #countdown { font-family: monospace; font-size: 1.1rem; color: #fff; margin-top: 5px; display: block; }
        
        .code-btn { margin-top: 12px; background: none; border: 1px dashed var(--pink); color: var(--pink); padding: 8px 15px; border-radius: 10px; font-size: 0.75rem; cursor: pointer; }

        #gacha-container { position: relative; width: 300px; height: 350px; margin-top: 10px; }
        #gacha-machine { width: 100%; height: 100%; object-fit: contain; position: relative; z-index: 10; }

        #capsule {
            position: absolute; bottom: 60px; right: 40px; width: 70px; height: 70px; z-index: 100; display: none;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.5));
        }
        .capsule-inner { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; }
        .capsule-top {
            position: absolute; top: 0; width: 100%; height: 50%; border-radius: 35px 35px 0 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.5) 0%, transparent 50%), var(--cap-color, #333);
            border: 1px solid rgba(255,255,255,0.3); transition: all 0.5s ease-out;
        }
        .capsule-bottom {
            position: absolute; bottom: 0; width: 100%; height: 50%; border-radius: 0 0 35px 35px;
            background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(2px); border: 1px solid rgba(255,255,255,0.4); transition: all 0.5s ease-out;
        }

        .pop-out { display: block !important; animation: capsule-fly 1.2s cubic-bezier(0.25, 0.1, 0.25, 1) forwards; }
        @keyframes capsule-fly {
            0% { transform: translate(0, 0) scale(0.3) rotate(0deg); }
            30% { transform: translate(-50px, -150px) scale(1.2) rotate(180deg); }
            100% { transform: translate(-115px, -100px) scale(2.8) rotate(720deg); }
        }
        .capsule-split .capsule-top { transform: translateY(-80px) rotate(-40deg); opacity: 0; }
        .capsule-split .capsule-bottom { transform: translateY(80px) rotate(40deg); opacity: 0; }

        .btn { margin-top: 10px; padding: 18px 60px; background: linear-gradient(to bottom, #ffc0cb, #ff69b4); color: white; border: none; border-radius: 50px; font-weight: 700; font-size: 1.1rem; box-shadow: 0 5px 0 #db7093; cursor: pointer; }
        .btn:disabled { background: #666; box-shadow: 0 5px 0 #444; cursor: not-allowed; }

        #collection-btn { 
            position: fixed; right: 20px; bottom: 30px; width: 65px; height: 65px; 
            background: var(--gold); border-radius: 50%; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 100; border: 2px solid white; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); animation: fuwafuwa 2.5s ease-in-out infinite;
        }
        @keyframes fuwafuwa { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }

        #collection-screen { position: fixed; inset: 0; background: #1a1a1a; z-index: 300; display: none; flex-direction: column; }
        .col-header { padding: 15px; text-align: center; border-bottom: 1px solid #333; }
        .col-count-text { color: var(--gold); font-weight: bold; margin-top: 10px; display: block; line-height: 1.4; }
        .col-grid { flex: 1; overflow-y: auto; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        .card-slot { aspect-ratio: 2/3.5; background: #2a2a2a; border-radius: 8px; border: 1px solid #444; display: flex; align-items: center; justify-content: center; overflow: hidden; color: #555; cursor: pointer; }
        .card-slot img { width: 100%; height: 100%; object-fit: cover; }

        #viewer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 500; display: none; flex-direction: column; align-items: center; justify-content: center; touch-action: none; }
        .viewer-scene { width: 280px; height: 480px; perspective: 1200px; }
        .card-3d { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.1s ease-out; }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 18px; border: 4px solid var(--gold); overflow: hidden; }
        .face-front { background: black; }
        .face-front img { width: 100%; height: 100%; object-fit: cover; }
        .face-back { background: #2a2a2a; transform: rotateY(180deg); }
        .face-back img { width: 100%; height: 100%; object-fit: cover; }
        .viewer-hint { margin-top: 25px; color: var(--gold); font-size: 0.8rem; animation: pulse 1.5s infinite; }

        #result-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.92); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 400; }
        .card-reveal { width: 70%; max-width: 250px; aspect-ratio: 2/3.5; border: 3px solid var(--gold); border-radius: 15px; overflow: hidden; background: black; transform: scale(0); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .card-reveal.active { transform: scale(1); }
        .card-reveal img { width: 100%; height: 100%; object-fit: cover; }
        #detail { width: 85%; max-width: 320px; background: #fefcf0; color: #333; padding: 15px; border-radius: 20px; margin-top: 15px; text-align: center; opacity: 0; }
        #detail.active { opacity: 1; transition: opacity 0.5s; }

        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: rotate(0); } 50% { transform: rotate(-3deg); } }
    </style>
</head>
<body>

    <div class="title"><img src="images/icon2.png">LOVE Message Gacha</div>
    <div id="coin-display">ãƒŸãƒ«ã‚³ã‚¤ãƒ³: <span id="coin-count">0</span> æš</div>

    <div id="limit-info">
        <span id="limit-text"></span>
        <div id="timer-container" style="display:none; margin-top:10px;">
            <span id="countdown">--:--:--</span>
        </div>
        <button class="code-btn" onclick="enterCode()">ç§˜å¯†ã®ã‚³ãƒ¼ãƒ‰</button>
    </div>

    <div id="gacha-container">
        <img src="images/gacha.png" id="gacha-machine">
        <div id="capsule"><div class="capsule-inner"><div class="capsule-top"></div><div class="capsule-bottom"></div></div></div>
    </div>

    <button class="btn" id="play-btn" onclick="playGacha()">ã‚¬ãƒãƒ£ã‚’å›ã™</button>
    <div id="collection-btn" onclick="openCollection()">ğŸ“–<br><span style="font-size:0.6rem;">ãƒ¬ã‚¢å›³é‘‘</span></div>

    <div id="collection-screen">
        <div class="col-header">
            <button onclick="closeCollection()" style="background:var(--pink); border:none; padding:10px 30px; border-radius:20px; color:white; font-weight:bold;">æˆ»ã‚‹</button>
            <span class="col-count-text" id="col-count-display"></span>
        </div>
        <div class="col-grid" id="col-grid"></div>
    </div>

    <div id="viewer-overlay">
        <div class="viewer-scene">
            <div class="card-3d" id="card-3d-target">
                <div class="card-face face-front"><img id="viewer-img-front" src=""></div>
                <div class="card-face face-back"><img src="images/back.png"></div>
            </div>
        </div>
        <div class="viewer-hint">å·¦å³ã«ãªãã£ã¦å›è»¢ âœ¨</div>
        <button onclick="closeViewer()" style="margin-top:30px; background:white; color:black; border:none; padding:12px 40px; border-radius:25px; font-weight:bold;">é–‰ã˜ã‚‹</button>
    </div>

    <div id="result-overlay" onclick="closeResult()">
        <div class="card-reveal" id="card-box"></div>
        <div id="detail"><h2 id="card-name" style="margin:0; font-size:1rem; color:#d44d7c;"></h2><p id="card-desc" style="font-size:0.8rem; margin-top:8px;"></p></div>
    </div>

    <script>
        const tarotData = [
            { id: 0, name: "0. FOOL", desc: "ä»Šã¯å®Œç’§ã˜ã‚ƒãªãã¦ã„ã„æ‹âœ¨å…ˆã®ä¸å®‰ã‚ˆã‚Šã€Œå¥½ãã€ã¨ã„ã†ç´”ç²‹ãªæ°—æŒã¡ã‚’ä¿¡ã˜ã¦ã€‚å‹‡æ°—ã‚ã‚‹ä¸€æ­©ãŒã€æ€ã„ãŒã‘ãªã„å¹¸ã›ã«ç¹‹ãŒã‚Šã¾ã™ğŸŒˆ", img: "images/0.png" },
            { id: 1, name: "1. MAGICIAN", desc: "ã‚ãªãŸã®æƒ³ã„ã«ã¯ç¾å®Ÿã‚’å‹•ã‹ã™åŠ›ãŒã‚ã‚Šã¾ã™ğŸ’«é§†ã‘å¼•ãã‚ˆã‚Šç´ ç›´ãªè¨€è‘‰ã‚’ã€‚ä¼ãˆã‚‹ã“ã¨ã§ã€æ‹ã¯ã¯ã£ãã‚Šã¨å½¢ã‚’æŒã¡å§‹ã‚ã¾ã™ğŸ’Œ", img: "images/1.png" },
            { id: 2, name: "2. HIGH PRIESTESS", desc: "ç›¸æ‰‹ã®æœ¬å¿ƒã¯è¨€è‘‰ã‚ˆã‚Šæ…‹åº¦ã«è¡¨ã‚Œã¦ã„ã¾ã™ğŸŒ™ç„¦ã‚‰ãšé™ã‹ã«è¦‹å®ˆã£ã¦ã€‚ã‚ãªãŸã®ç›´æ„Ÿã¯ä»Šã€ã¨ã¦ã‚‚å†´ãˆã¦ã„ã¾ã™ğŸ•Šï¸", img: "images/2.png" },
            { id: 3, name: "3. EMPRESS", desc: "æ„›ã•ã‚Œã‚‹ã“ã¨ã‚’é æ…®ã—ãªã„ã§ğŸ’å—ã‘å–ã‚‹è¦šæ‚ŸãŒã§ããŸæ™‚ã€æ‹ã¯è‡ªç„¶ã¨æº€ãŸã•ã‚Œã¦ã„ãã¾ã™ã€‚è‡ªåˆ†ã‚’ç”˜ã‚„ã‹ã™ã®ã‚‚å¤§åˆ‡ãªæ„›ğŸ’–", img: "images/3.png" },
            { id: 4, name: "4. EMPEROR", desc: "å®‰å¿ƒã§ãã‚‹é–¢ä¿‚ã¯è‡ªåˆ†è»¸ã‹ã‚‰âœ¨ç„¡ç†ã«åˆã‚ã›ãšã€è‡ªåˆ†ã‚’å¤§åˆ‡ã«ã™ã‚‹å§¿å‹¢ãŒç›¸æ‰‹ã®ä¿¡é ¼ã‚’è‚²ã¦ã¾ã™ğŸ°", img: "images/4.png" },
            { id: 5, name: "5. HIEROPHANT", desc: "èª å®Ÿãªæƒ³ã„ã¯æ™‚é–“ã‚’ã‹ã‘ã¦å®Ÿã‚’çµã³ã¾ã™ğŸŒ¿å‘¨å›²ã®å¸¸è­˜ã‚ˆã‚Šã€å¿ƒãŒã€Œæ­£ã—ã„ã€ã¨æ„Ÿã˜ã‚‹é¸æŠã‚’ğŸ¤", img: "images/5.png" },
            { id: 6, name: "6. LOVERS", desc: "è¿·ã„ã¯æœ¬æ°—ã®è¨¼æ‹ ğŸ’å¿ƒãŒå¼·ãæƒ¹ã‹ã‚Œã‚‹æ–¹ã‚’é¸ã‚“ã§ã€‚é¸æŠã—ãŸå…ˆã§ã€ã‚ãªãŸã®æ‹ã¯æ·±ã¾ã£ã¦ã„ãã¾ã™âœ¨", img: "images/6.png" },
            { id: 7, name: "7. CHARIOT", desc: "ä»Šã¯å¾…ã¤ã‚ˆã‚Šå‹•ãæ™‚ğŸš€å°ã•ãªè¡Œå‹•ãŒå¤§ããªé€²å±•ã«ã€‚å‹‡æ°—ã‚’å‡ºã—ãŸã‚ãªãŸã«ã€æ‹ã¯å‘³æ–¹ã—ã¾ã™ğŸ”¥", img: "images/7.png" },
            { id: 8, name: "8. STRENGTH", desc: "å„ªã—ã•ã¯æœ€å¤§ã®å¼·ã•ğŸ¦ç„¡ç†ã«é ‘å¼µã‚‰ãªãã¦å¤§ä¸ˆå¤«ã€‚ã‚ãªãŸã®æ€ã„ã‚„ã‚ŠãŒã€ç›¸æ‰‹ã®å¿ƒã‚’è‡ªç„¶ã¨é–‹ãã¾ã™ğŸ’—", img: "images/8.png" },
            { id: 9, name: "9. HERMIT", desc: "ä¸€äººã®æ™‚é–“ã¯æ‹ã‚’æ•´ãˆã‚‹ãŸã‚ğŸŒ™é™ã‹ã«å‘ãåˆã†ã“ã¨ã§ã€æœ¬å½“ã«æœ›ã‚€æ„›ãŒè¦‹ãˆã¦ãã¾ã™ğŸ•¯ï¸", img: "images/9.png" },
            { id: 10, name: "10. WHEEL OF FORTUNE", desc: "æµã‚ŒãŒå¤§ããå‹•ãæ™‚ğŸ¡å¶ç„¶ã®å‡ºæ¥äº‹ã«ã“ãæ„å‘³ãŒã‚ã‚Šã¾ã™ã€‚ãƒãƒ£ãƒ³ã‚¹ã¯ã™ã§ã«å·¡ã£ã¦ãã¦ã„ã¾ã™âœ¨", img: "images/10.png" },
            { id: 11, name: "11. JUSTICE", desc: "æœ¬éŸ³ã¨è¡Œå‹•ã‚’ä¸€è‡´ã•ã›ã¦âš–ï¸èª å®Ÿãªé¸æŠã¯ã€å¾Œæ‚”ã—ãªã„æ‹ã‚’å¼•ãå¯„ã›ã¾ã™ğŸ¤", img: "images/11.png" },
            { id: 12, name: "12. HANGED MAN", desc: "ä»Šã¯å‹•ã‹ãªãã¦ã‚‚å¤§ä¸ˆå¤«ğŸŒ±å¾…ã¤æ™‚é–“ãŒæ„›ã‚’è‚²ã¦ã¦ã„ã¾ã™ã€‚è¦‹æ–¹ã‚’å¤‰ãˆã‚‹ã¨ç­”ãˆãŒè¦‹ãˆã¦ãã‚‹âœ¨", img: "images/12.png" },
            { id: 13, name: "13. DEATH", desc: "çµ‚ã‚ã‚Šã¯æ–°ã—ã„å§‹ã¾ã‚ŠğŸ–¤æ‰‹æ”¾ã—ãŸå…ˆã«ã€ã‚‚ã£ã¨å¹¸ã›ãªæ‹ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ğŸŒ¹", img: "images/13.png" },
            { id: 14, name: "14. TEMPERANCE", desc: "ç„¡ç†ã®ãªã„é–¢ä¿‚ãŒé•·ç¶šãğŸ’æ­©å¹…ã‚’åˆã‚ã›ã‚‹ã“ã¨ã§ã€å¿ƒåœ°ã‚ˆã„æ„›ã®å½¢ãŒæ•´ã„ã¾ã™ğŸŒ¸", img: "images/14.png" },
            { id: 15, name: "15. DEVIL", desc: "ãã‚Œã¯æ„›ï¼Ÿãã‚Œã¨ã‚‚åŸ·ç€ï¼ŸğŸ•¸ï¸è‹¦ã—ããªã‚‹æ‹ã¯è¦‹ç›´ã—ã¦ã€‚è‡ªç”±ãªå¿ƒãŒæœ¬å½“ã®å¹¸ã›ã‚’å‘¼ã³ã¾ã™âœ¨", img: "images/15.png" },
            { id: 16, name: "16. TOWER", desc: "è¡æ’ƒã¯çœŸå®Ÿã‚’çŸ¥ã‚‹ãŸã‚âš¡å£Šã‚ŒãŸå¹»æƒ³ã®å…ˆã«ã€å½ã‚Šã®ãªã„æ„›ãŒå¾…ã£ã¦ã„ã¾ã™ğŸŒˆ", img: "images/16.png" },
            { id: 17, name: "17. STAR", desc: "å¸Œæœ›ã‚’æ‰‹æ”¾ã•ãªã„ã§ğŸŒŸãã®æ‹ã¯ã¾ã å¯èƒ½æ€§ã«æº€ã¡ã¦ã„ã¾ã™ã€‚ä¿¡ã˜ã‚‹å¿ƒãŒæœªæ¥ã‚’ç…§ã‚‰ã—ã¾ã™ğŸ’«", img: "images/17.png" },
            { id: 18, name: "18. MOON", desc: "ä¸å®‰ã¯æ€ã„è¾¼ã¿ã‹ã‚‚ğŸŒ™ç¢ºã‹ã‚ã‚‹å‹‡æ°—ã‚’ã€‚çœŸå®Ÿã‚’çŸ¥ã‚‹ã“ã¨ã§ã€å¿ƒã¯é™ã‹ã«è½ã¡ç€ãã¾ã™ğŸ¤", img: "images/18.png" },
            { id: 19, name: "19. SUN", desc: "ç´ ç›´ãªç¬‘é¡”ãŒæ‹ã‚’è¼ã‹ã›ã¾ã™â˜€ï¸å–œã³ã‚’åˆ†ã‹ã¡åˆãˆã‚‹é–¢ä¿‚ãŒã€ã‚ãªãŸã‚’å¹¸ã›ã«ã—ã¾ã™ğŸ’›", img: "images/19.png" },
            { id: 20, name: "20. JUDGEMENT", desc: "éå»ã®æ‹ã«ç­”ãˆãŒå‡ºã‚‹æ™‚ğŸ“¯è¨±ã—ã¨æ°—ã¥ããŒã€æ–°ã—ã„æ„›ã¸ã®æ‰‰ã‚’é–‹ãã¾ã™âœ¨", img: "images/20.png" },
            { id: 21, name: "21. WORLD", desc: "å¿ƒã‹ã‚‰æº€ãŸã•ã‚Œã‚‹æ‹ãŒå®ŒæˆğŸ’ã‚ã‚Šã®ã¾ã¾ã®ã‚ãªãŸã§ã€æ„›ã•ã‚Œã‚‹å¹¸ã›ã‚’å—ã‘å–ã£ã¦ğŸŒˆ", img: "images/21.png" },
            { id: 36, name: "ACE OF CUPS", desc: "æ–°ã—ã„æ„›ã®å§‹ã¾ã‚ŠğŸ’—å¿ƒãŒè‡ªç„¶ã¨å‹•ãå‡ºä¼šã„ã‚„æ„Ÿæƒ…ãŒè¨ªã‚Œã¾ã™ã€‚æ€–ãŒã‚‰ãšã€ãã®ã¨ãã‚ãã‚’å—ã‘å–ã£ã¦ğŸŒ¸", img: "images/36.png" },
            { id: 37, name: "TWO OF CUPS", desc: "å¿ƒã¨å¿ƒãŒé€šã„åˆã†æ™‚ğŸ’•å¯¾ç­‰ãªæ„›ã€ç´ ç›´ãªæ°—æŒã¡ã®äº¤æ›ãŒæ‹ã‚’æ·±ã‚ã¾ã™ã€‚å®‰å¿ƒã—ã¦æƒ³ã„ã‚’å…±æœ‰ã—ã¦âœ¨", img: "images/37.png" },
            { id: 38, name: "THREE OF CUPS", desc: "å–œã³ã‚’åˆ†ã‹ã¡åˆãˆã‚‹é–¢ä¿‚ğŸ¥‚æ‹ã¯æ¥½ã—ã„æ™‚é–“ã®ä¸­ã§è‚²ã¡ã¾ã™ã€‚ç¬‘é¡”ã¨æ„Ÿè¬ã‚’å¿˜ã‚Œãšã«ğŸŒ·", img: "images/38.png" },
            { id: 39, name: "FOUR OF CUPS", desc: "æ°—æŒã¡ãŒåœæ»ã—ãŒã¡ğŸ˜Œã§ã‚‚æœ¬å½“ã¯ã€ã™ããã°ã«æ„›ã®ãƒãƒ£ãƒ³ã‚¹ãŒã€‚å¿ƒã‚’å°‘ã—é–‹ã„ã¦ã¿ã¦â˜ï¸", img: "images/39.png" },
            { id: 40, name: "FIVE OF CUPS", desc: "å¤±ã£ãŸã‚‚ã®ã°ã‹ã‚Šè¦‹ãªã„ã§ğŸŒ§ï¸ã¾ã æ®‹ã£ã¦ã„ã‚‹æ„›ãŒã‚ã‚Šã¾ã™ã€‚éå»ã‚ˆã‚Šæœªæ¥ã«ç›®ã‚’å‘ã‘ã¦ğŸŒˆ", img: "images/40.png" },
            { id: 41, name: "SIX OF CUPS", desc: "æ‡ã‹ã—ã„æƒ³ã„ãŒå¿ƒã‚’æ¸©ã‚ã¾ã™ğŸ€éå»ã®æ‹ã‚„å†ä¼šãŒãƒ’ãƒ³ãƒˆã«ã€‚å„ªã—ã„æ°—æŒã¡ã‚’å¤§åˆ‡ã«ğŸ’", img: "images/41.png" },
            { id: 42, name: "SEVEN OF CUPS", desc: "è¿·ã„ãŒç”Ÿã˜ã‚„ã™ã„æ™‚â˜ï¸ç”˜ã„å¹»æƒ³ã‚ˆã‚Šã€ç¾å®Ÿã®æ„›ã‚’é¸ã‚“ã§ã€‚å¿ƒãŒè½ã¡ç€ãæ–¹ãŒç­”ãˆâœ¨", img: "images/42.png" },
            { id: 43, name: "EIGHT OF CUPS", desc: "é›¢ã‚Œã‚‹å‹‡æ°—ã‚‚æ„›ã®å½¢ğŸŒ™æº€ãŸã•ã‚Œãªã„é–¢ä¿‚ã‹ã‚‰å’æ¥­ã—ã¦ã€æ–°ã—ã„å¹¸ã›ã¸é€²ã‚“ã§ğŸšª", img: "images/43.png" },
            { id: 44, name: "NINE OF CUPS", desc: "é¡˜ã„ãŒå¶ã†ï¼ˆãƒ¬ã‚¢ï¼‰ğŸ’–è‡ªåˆ†ã®å¹¸ã›ã‚’ç´ ç›´ã«æœ›ã‚“ã§OKã€‚æº€è¶³æ„Ÿã®ã‚ã‚‹æ‹ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™âœ¨", img: "images/44.png" },
            { id: 45, name: "TEN OF CUPS", desc: "å¿ƒã‹ã‚‰ã®å¹¸ã›ğŸ’å®‰å¿ƒã¨æ„›ã«åŒ…ã¾ã‚Œã‚‹é–¢ä¿‚ã€‚ã‚ãªãŸãŒæœ›ã‚“ã§ããŸæ„›ã®å®Œæˆå½¢ã§ã™ğŸŒˆ", img: "images/45.png" },
            { id: 46, name: "PAGE OF CUPS", desc: "ãƒ”ãƒ¥ã‚¢ãªæ‹å¿ƒãŒèŠ½ç”Ÿãˆã¾ã™ğŸšå°ã•ãªã¨ãã‚ãã‚’å¤§åˆ‡ã«ã€‚ç´ ç›´ã•ãŒæ‹ã‚’å‹•ã‹ã—ã¾ã™ğŸ’“", img: "images/46.png" },
            { id: 47, name: "KNIGHT OF CUPS", desc: "ãƒ­ãƒãƒ³ãƒãƒƒã‚¯ãªå±•é–‹ğŸŒ¹æƒ³ã„ã‚’è¡Œå‹•ã§ç¤ºã™æ™‚ã€‚æ„›ã‚’ä¿¡ã˜ã¦ä¸€æ­©è¸ã¿å‡ºã—ã¦âœ¨", img: "images/47.png" },
            { id: 48, name: "QUEEN OF CUPS", desc: "æ·±ã„æ€ã„ã‚„ã‚ŠãŒæ‹ã‚’ç™’ã—ã¾ã™ğŸŒŠã‚ãªãŸã®å„ªã—ã•ã¯ååˆ†ä¼ã‚ã£ã¦ã„ã¾ã™ã€‚è‡ªåˆ†ã‚‚åŠ´ã£ã¦ğŸ’—", img: "images/48.png" },
            { id: 49, name: "KING OF CUPS", desc: "æ„Ÿæƒ…ã‚’å®‰å®šã•ã›ã¦ğŸ‘‘æˆç†Ÿã—ãŸæ„›ãŒè‚²ã¤æ™‚ã€‚å†·é™ã•ã¨æ€ã„ã‚„ã‚ŠãŒé–¢ä¿‚ã‚’æ”¯ãˆã¾ã™âœ¨", img: "images/49.png" },
            { id: 50, name: "ACE OF SWORDS", desc: "çœŸå®ŸãŒæ˜ã‚‰ã‹ã«âš¡ã¯ã£ãã‚Šã—ãŸè¨€è‘‰ãŒæ‹ã‚’å‰é€²ã•ã›ã¾ã™ã€‚æ›–æ˜§ã•ã¯æ‰‹æ”¾ã—ã¦âœ¨", img: "images/50.png" },
            { id: 51, name: "TWO OF SWORDS", desc: "æ±ºæ–­ã‚’é¿ã‘ã¦ã„ã¾ã›ã‚“ã‹ğŸŒ«ï¸å¿ƒã‚’é–‰ã˜ãŸã¾ã¾ã§ã¯é€²ã‚ã¾ã›ã‚“ã€‚å‘ãåˆã†å‹‡æ°—ã‚’ğŸ¤", img: "images/51.png" },
            { id: 52, name: "THREE OF SWORDS", desc: "å¿ƒãŒå‚·ã¤ãå‡ºæ¥äº‹ğŸ’”ã§ã‚‚ç—›ã¿ã¯ç™’ãˆã¾ã™ã€‚æ­£ç›´ãªæ°—æŒã¡ãŒå›å¾©ã®éµğŸŒ±", img: "images/52.png" },
            { id: 53, name: "FOUR OF SWORDS", desc: "ä¼‘æ¯ãŒå¿…è¦ğŸ•Šï¸æ‹ã«ç–²ã‚ŒãŸå¿ƒã‚’æ•´ãˆã¦ã€‚ä»Šã¯ç„¡ç†ã«å‹•ã‹ãªãã¦å¤§ä¸ˆå¤«âœ¨", img: "images/53.png" },
            { id: 54, name: "FIVE OF SWORDS", desc: "å‹ã¡è² ã‘ã«ã“ã ã‚ã‚‰ãªã„ã§âš”ï¸å‚·ã¤ãæ‹ã‹ã‚‰è·é›¢ã‚’ã€‚è‡ªåˆ†ã‚’å®ˆã‚‹é¸æŠã‚’ğŸ¤", img: "images/54.png" },
            { id: 55, name: "SIX OF SWORDS", desc: "å¿ƒãŒè»½ããªã‚‹æ–¹å‘ã¸ğŸš¤é™ã‹ã«å‰é€²ã—ã¦ã„ã¾ã™ã€‚éå»ã®ç—›ã¿ã‹ã‚‰æŠœã‘å‡ºã›ã‚‹æ™‚ğŸŒˆ", img: "images/55.png" },
            { id: 56, name: "SEVEN OF SWORDS", desc: "éš ã—äº‹ã‚„ä¸å®‰ã«æ³¨æ„ğŸ•¶ï¸é•å’Œæ„Ÿã¯è¦‹é€ƒã•ãªã„ã§ã€‚èª å®Ÿã•ãŒå¤§åˆ‡ã§ã™âœ¨", img: "images/56.png" },
            { id: 57, name: "EIGHT OF SWORDS", desc: "è‡ªåˆ†ã§è‡ªåˆ†ã‚’ç¸›ã‚‰ãªã„ã§â›“ï¸æ€ã„è¾¼ã¿ã‚’å¤–ã›ã°ã€æ‹ã¯å‹•ãå‡ºã—ã¾ã™ğŸŒ¬ï¸", img: "images/57.png" },
            { id: 58, name: "NINE OF SWORDS", desc: "ä¸å®‰ãŒè†¨ã¿ã‚„ã™ã„å¤œğŸŒ™ã§ã‚‚ç¾å®Ÿã¯æ€ã†ã»ã©æ‚ªããªã„ã€‚å¿ƒã‚’ä¼‘ã¾ã›ã¦ğŸ«§", img: "images/58.png" },
            { id: 59, name: "TEN OF SWORDS", desc: "ã©ã‚“åº•ã¯å†ç”Ÿã®å§‹ã¾ã‚ŠğŸŒ‘ã“ã‚Œä»¥ä¸Šå‚·ã¤ã‹ãªã„ãŸã‚ã®çµ‚ã‚ã‚Šã€‚å¿…ãšæœã¯æ¥ã¾ã™ğŸŒ…", img: "images/59.png" },
            { id: 60, name: "PAGE OF SWORDS", desc: "æ°—ã«ãªã‚‹ç›¸æ‰‹ã‚’è¦³å¯Ÿä¸­ğŸ‘€ç„¦ã‚‰ãšè·é›¢æ„Ÿã‚’ä¿ã£ã¦ã€‚æƒ…å ±åé›†ã®æ™‚âœ¨", img: "images/60.png" },
            { id: 61, name: "KNIGHT OF SWORDS", desc: "å‹¢ã„ã‚ã‚‹å±•é–‹âš¡è¨€è‘‰ãŒå¼·ããªã‚ŠãŒã¡ã€‚å†·é™ã•ã‚’å¿˜ã‚Œãªã„ã§ğŸ¤", img: "images/61.png" },
            { id: 62, name: "QUEEN OF SWORDS", desc: "è‡ªç«‹ã—ãŸæ„›ğŸ‘‘æ„Ÿæƒ…ã‚ˆã‚Šç†æ€§ã‚’å¤§åˆ‡ã«ã€‚ã‚ãªãŸã®åˆ¤æ–­ã¯æ­£ã—ã„âœ¨", img: "images/62.png" },
            { id: 63, name: "KING OF SWORDS", desc: "è«–ç†çš„ã§èª å®Ÿãªé–¢ä¿‚ğŸ§ è©±ã—åˆã„ãŒæ‹ã‚’å®‰å®šã•ã›ã¾ã™ã€‚ä¿¡é ¼ã‚’ç¯‰ã„ã¦âœ¨", img: "images/63.png" },
            { id: 22, name: "ACE OF WANDS", desc: "æƒ…ç†±ã®å§‹ã¾ã‚ŠğŸ”¥ä¸€æ°—ã«æ‹ãŒå‹•ãäºˆæ„Ÿã€‚ãƒ¯ã‚¯ãƒ¯ã‚¯ã‚’ä¿¡ã˜ã¦è¡Œå‹•ã‚’âœ¨", img: "images/22.png" },
            { id: 23, name: "TWO OF WANDS", desc: "æœªæ¥ã‚’è¦‹æ®ãˆã‚‹æ™‚ğŸŒå¯èƒ½æ€§ã¯åºƒãŒã£ã¦ã„ã¾ã™ã€‚æ¬¡ã®ä¸€æ­©ã‚’é¸ã‚“ã§âœ¨", img: "images/23.png" },
            { id: 24, name: "THREE OF WANDS", desc: "æ‹ã¯é †èª¿ã«é€²è¡Œä¸­â›µç„¦ã‚‰ãšå¾…ã¦ã°ã€æœ›ã‚€å±•é–‹ãŒã‚„ã£ã¦ãã¾ã™ğŸŒˆ", img: "images/24.png" },
            { id: 25, name: "FOUR OF WANDS", desc: "å®‰å¿ƒã§ãã‚‹é–¢ä¿‚ğŸ¡å¿ƒãŒè½ã¡ç€ãç›¸æ‰‹ã“ãæœ¬å‘½ã€‚å–œã³ã‚’å…±æœ‰ã—ã¦ğŸ’", img: "images/25.png" },
            { id: 26, name: "FIVE OF WANDS", desc: "å°ã•ãªè¡çªâš¡ã§ã‚‚æœ¬éŸ³ã‚’çŸ¥ã‚‹ãƒãƒ£ãƒ³ã‚¹ã€‚æ„Ÿæƒ…çš„ã«ãªã‚‰ãªã„ã§âœ¨", img: "images/26.png" },
            { id: 27, name: "SIX OF WANDS", desc: "æ‹ã®å‹åˆ©ğŸ‰èªã‚ã‚‰ã‚Œã‚‹ã€é¸ã°ã‚Œã‚‹æµã‚Œã€‚è‡ªä¿¡ã‚’æŒã£ã¦OKğŸ’–", img: "images/27.png" },
            { id: 28, name: "SEVEN OF WANDS", desc: "ç«‹å ´ã‚’å®ˆã‚‹æ™‚ğŸ›¡ï¸å¤§åˆ‡ãªæ‹ãªã‚‰ã€ç°¡å˜ã«è­²ã‚‰ãªã„ã§âœ¨", img: "images/28.png" },
            { id: 29, name: "EIGHT OF WANDS", desc: "æ€¥å±•é–‹ğŸ“©é€£çµ¡ã‚„é€²å±•ãŒä¸€æ°—ã«åŠ é€Ÿã€‚æµã‚Œã«ä¹—ã£ã¦ğŸŒ¬ï¸", img: "images/29.png" },
            { id: 30, name: "NINE OF WANDS", desc: "ã‚ã¨ä¸€æ­©ã§å®ŒæˆğŸš§ç–²ã‚Œã¦ã‚‚è«¦ã‚ãªã„ã§ã€‚ã‚ãªãŸã¯å®ˆã‚‰ã‚Œã¦ã„ã¾ã™âœ¨", img: "images/30.png" },
            { id: 31, name: "TEN OF WANDS", desc: "èƒŒè² ã„ã™ãğŸ’¦æ‹ã¯ä¸€äººã§é ‘å¼µã‚‰ãªãã¦ã„ã„ã€‚åŠ›ã‚’æŠœã„ã¦ğŸ¤", img: "images/31.png" },
            { id: 32, name: "PAGE OF WANDS", desc: "æ–°ã—ã„æ‹ã®äºˆæ„Ÿâœ¨å¥½å¥‡å¿ƒã«å¾“ã£ã¦ã€‚è»½ã‚„ã‹ã•ãŒå¹¸é‹ã‚’å‘¼ã³ã¾ã™ğŸŒŸ", img: "images/32.png" },
            { id: 33, name: "KNIGHT OF WANDS", desc: "æƒ…ç†±çš„ãªæ‹ğŸ”¥å‹¢ã„ã¯ã‚ã‚‹ã‘ã©æŒç¶šåŠ›ã‚’æ„è­˜ã—ã¦ã€‚æ…é‡ã•ã‚‚å¤§åˆ‡âœ¨", img: "images/33.png" },
            { id: 34, name: "QUEEN OF WANDS", desc: "é­…åŠ›ãŒè¼ãæ™‚ğŸ’ƒè‡ªä¿¡ã¨ç¬‘é¡”ãŒæ‹ã‚’å¼•ãå¯„ã›ã¾ã™ã€‚ä¸»å½¹ã¯ã‚ãªãŸğŸ’–", img: "images/34.png" },
            { id: 35, name: "KING OF WANDS", desc: "ãƒªãƒ¼ãƒ‰ã™ã‚‹æ„›ğŸ‘‘é ¼ã‚Œã‚‹å­˜åœ¨ã¨ã®é–¢ä¿‚ã€‚æƒ…ç†±ã¨è²¬ä»»ã®ãƒãƒ©ãƒ³ã‚¹ã‚’âœ¨", img: "images/35.png" },
            { id: 64, name: "ACE OF PENTACLES", desc: "ç¾å®Ÿçš„ãªãƒãƒ£ãƒ³ã‚¹ğŸŒ±å®‰å®šã—ãŸæ‹ã®ç¨®ãŒã¾ã‹ã‚Œã¾ã™ã€‚å¤§åˆ‡ã«è‚²ã¦ã¦âœ¨", img: "images/64.png" },
            { id: 65, name: "TWO OF PENTACLES", desc: "ãƒãƒ©ãƒ³ã‚¹èª¿æ•´âš–ï¸æ‹ã¨ç¾å®Ÿã®ä¸¡ç«‹ã‚’ã€‚ç„¡ç†ã—ãªã„é¸æŠã‚’ğŸ¤", img: "images/65.png" },
            { id: 66, name: "THREE OF PENTACLES", desc: "å”åŠ›ãŒéµğŸ”§äºŒäººã§ç¯‰ãé–¢ä¿‚ã€‚åŠªåŠ›ãŒå½¢ã«ãªã‚Šã¾ã™âœ¨", img: "images/66.png" },
            { id: 67, name: "FOUR OF PENTACLES", desc: "åŸ·ç€ã«æ³¨æ„ğŸ”’æ¡ã‚Šã—ã‚ã™ãã‚‹ã¨è‹¦ã—ããªã‚Šã¾ã™ã€‚ä¿¡é ¼ã—ã¦ğŸ’«", img: "images/67.png" },
            { id: 68, name: "FIVE OF PENTACLES", desc: "å­¤ç‹¬ã‚’æ„Ÿã˜ã‚„ã™ã„æ™‚â„ï¸ã§ã‚‚ã‚ãªãŸã¯ä¸€äººã˜ã‚ƒãªã„ã€‚åŠ©ã‘ã‚’å—ã‘å–ã£ã¦ğŸ¤", img: "images/68.png" },
            { id: 69, name: "SIX OF PENTACLES", desc: "ä¸ãˆã‚‹æ„›ã€å—ã‘å–ã‚‹æ„›ğŸãƒãƒ©ãƒ³ã‚¹ãŒæ•´ã†æ™‚ã€‚å„ªã—ã•ãŒå¾ªç’°ã—ã¾ã™âœ¨", img: "images/69.png" },
            { id: 70, name: "SEVEN OF PENTACLES", desc: "çµæœã‚’å¾…ã¤æ™‚â³æ‹ã¯ç€å®Ÿã«è‚²ã£ã¦ã„ã¾ã™ã€‚ç„¦ã‚‰ãªãã¦å¤§ä¸ˆå¤«ğŸŒ¿", img: "images/70.png" },
            { id: 71, name: "EIGHT OF PENTACLES", desc: "ã‚³ãƒ„ã‚³ãƒ„åŠªåŠ›ğŸ”¨åŠªåŠ›ã¯è£åˆ‡ã‚Šã¾ã›ã‚“ã€‚èª å®Ÿã•ãŒä¿¡é ¼ã«âœ¨", img: "images/71.png" },
            { id: 72, name: "NINE OF PENTACLES", desc: "è‡ªç«‹ã—ãŸå¹¸ã›ğŸŒ¹ä¸€äººã§ã‚‚æº€ãŸã•ã‚Œã‚‹ã‹ã‚‰ã“ãã€è‰¯ã„æ‹ãŒæ¥ã¾ã™âœ¨", img: "images/72.png" },
            { id: 73, name: "TEN OF PENTACLES", desc: "å®‰å®šã—ãŸæœªæ¥ğŸ¡é•·ãç¶šãé–¢ä¿‚ã®æš—ç¤ºã€‚å®‰å¿ƒã§ãã‚‹æ„›ã§ã™ğŸ’", img: "images/73.png" },
            { id: 74, name: "PAGE OF PENTACLES", desc: "çœŸå‰£ãªå§‹ã¾ã‚ŠğŸ“˜èª å®Ÿãªæ°—æŒã¡ãŒèŠ½ç”Ÿãˆã¾ã™ã€‚ã‚†ã£ãã‚Šè‚²ã¦ã¦âœ¨", img: "images/74.png" },
            { id: 75, name: "KNIGHT OF PENTACLES", desc: "ç€å®Ÿãªæ„›ğŸ¢ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚ˆã‚Šç¶™ç¶šã€‚ä¿¡é ¼ã¯æ™‚é–“ã§æ·±ã¾ã‚Šã¾ã™ğŸ¤", img: "images/75.png" },
            { id: 76, name: "QUEEN OF PENTACLES", desc: "åŒ…ã¿è¾¼ã‚€æ„›ğŸŒ¼å®‰å¿ƒæ„Ÿã‚’ä¸ãˆã‚‹å­˜åœ¨ã€‚ã‚ãªãŸã®æ¸©ã‹ã•ãŒæ‹ã‚’å®ˆã‚Šã¾ã™ğŸ’–", img: "images/76.png" },
            { id: 77, name: "KING OF PENTACLES", desc: "å®‰å®šã¨ä¿¡é ¼ğŸ‘‘ç¾å®Ÿçš„ã§é ¼ã‚Œã‚‹æ„›ã€‚å°†æ¥ã‚’è€ƒãˆã‚‰ã‚Œã‚‹é–¢ä¿‚ã§ã™âœ¨", img: "images/77.png" },
            { id: 78, name: "ULTIMATE", desc: "ã‚ãªãŸã®æ‹ã¯ä»Šã€æœ€çµ‚æ®µéšã®æ‰‰ã®å‰ã«ã„ã¾ã™ğŸ’ã‚‚ã†ç–‘ã‚ãªãã¦å¤§ä¸ˆå¤«ã€‚ã“ã‚Œã¾ã§ã®æƒ³ã„ã¨é¸æŠã¯ã™ã¹ã¦æ­£è§£âœ¨è¦šæ‚Ÿã‚’æ±ºã‚ã¦å—ã‘å–ã‚‹ã“ã¨ã§ã€é‹å‘½ã®æ„›ãŒå®Œå…¨ã«å½¢ã«ãªã‚Šã¾ã™ğŸŒˆğŸ’–", img: "images/78.png" }
        ];

        const rareImgList = ["images/6.png", "images/17.png", "images/37.png", "images/44.png", "images/78.png"];
        let coins = parseInt(localStorage.getItem('miruCoins') || '2');
        let lastAccess = localStorage.getItem('lastAccessDate');
        let myCollection = JSON.parse(localStorage.getItem('myCollection') || '[]');
        let usedCodes = JSON.parse(localStorage.getItem('usedCodes') || '[]');

        function updateUI() {
            const today = new Date().toLocaleDateString();
            if (lastAccess !== today) {
                if (coins < 2) coins = 2; 
                lastAccess = today;
                localStorage.setItem('lastAccessDate', today);
            }
            document.getElementById('coin-count').innerText = coins;
            const btn = document.getElementById('play-btn');
            const limitText = document.getElementById('limit-text');
            const timerCon = document.getElementById('timer-container');

            if (coins <= 0) {
                btn.disabled = true;
                limitText.innerText = "ä»Šæ—¥ã®åˆ†ã¯çµ‚äº†ğŸŒ™ã¾ãŸæ˜æ—¥æ¥ã¦ã­ğŸ¦„";
                timerCon.style.display = "block";
            } else {
                btn.disabled = false;
                limitText.innerText = `ã‚ã¨ ${coins} å›å ãˆã‚‹ã‚ˆâœ¨`;
                timerCon.style.display = "none";
            }
            localStorage.setItem('miruCoins', coins);
        }

        setInterval(() => {
            const now = new Date();
            const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
            const diff = tomorrow - now;
            const h = Math.floor(diff / (1000 * 60 * 60)).toString().padStart(2,'0');
            const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2,'0');
            const s = Math.floor((diff % (1000 * 60)) / 1000).toString().padStart(2,'0');
            document.getElementById('countdown').innerText = `${h}:${m}:${s}`;
        }, 1000);

        function playGacha() {
            if (coins <= 0) return;
            coins--; updateUI();
            const machine = document.getElementById('gacha-machine');
            const cap = document.getElementById('capsule');
            cap.style.setProperty('--cap-color', ['#3498db', '#2ecc71', '#f1c40f', '#9b59b6'][Math.floor(Math.random() * 4)]);
            cap.classList.remove('pop-out', 'capsule-split');
            machine.style.animation = "shake 0.1s infinite";
            setTimeout(() => { machine.style.animation = "none"; cap.classList.add('pop-out'); }, 600);
            setTimeout(() => {
                cap.classList.add('capsule-split');
                const card = tarotData[Math.floor(Math.random() * tarotData.length)];
                if (rareImgList.includes(card.img) && !myCollection.includes(card.img)) {
                    myCollection.push(card.img);
                    localStorage.setItem('myCollection', JSON.stringify(myCollection));
                }
                document.getElementById('card-box').innerHTML = `<img src="${card.img}">`;
                document.getElementById('card-name').innerText = card.name;
                document.getElementById('card-desc').innerText = card.desc;
                document.getElementById('result-overlay').style.display = "flex";
                setTimeout(() => { document.getElementById('card-box').classList.add('active'); document.getElementById('detail').classList.add('active'); }, 100);
            }, 1800);
        }

        function openCollection() {
            const grid = document.getElementById('col-grid');
            grid.innerHTML = "";
            document.getElementById('col-count-display').innerText = `ãƒ¬ã‚¢ç™ºè¦‹ï¼š${myCollection.length} / 5 æš`;
            rareImgList.forEach(imgSrc => {
                const has = myCollection.includes(imgSrc);
                const slot = document.createElement('div');
                slot.className = 'card-slot';
                if(has) {
                    slot.innerHTML = `<img src="${imgSrc}">`;
                    slot.onclick = () => openViewer(imgSrc);
                } else {
                    slot.innerHTML = "?";
                }
                grid.appendChild(slot);
            });
            document.getElementById('collection-screen').style.display = "flex";
        }

        let isDragging = false;
        let startX, startY, rotY = 0, rotX = 0;
        const card3d = document.getElementById('card-3d-target');

        function openViewer(imgSrc) {
            document.getElementById('viewer-img-front').src = imgSrc;
            document.getElementById('viewer-overlay').style.display = "flex";
            rotY = 0; rotX = 0;
            card3d.style.transform = `rotateY(0deg) rotateX(0deg)`;
        }

        function closeViewer() { document.getElementById('viewer-overlay').style.display = "none"; }

        const viewer = document.getElementById('viewer-overlay');
        viewer.addEventListener('mousedown', dragStart);
        viewer.addEventListener('touchstart', dragStart, {passive: false});
        window.addEventListener('mousemove', dragMove);
        window.addEventListener('touchmove', dragMove, {passive: false});
        window.addEventListener('mouseup', dragEnd);
        window.addEventListener('touchend', dragEnd);

        function dragStart(e) {
            isDragging = true;
            startX = e.type.includes('mouse') ? e.pageX : e.touches[0].pageX;
            startY = e.type.includes('mouse') ? e.pageY : e.touches[0].pageY;
            card3d.style.transition = "none";
        }

        function dragMove(e) {
            if (!isDragging) return;
            e.preventDefault();
            const x = e.type.includes('mouse') ? e.pageX : e.touches[0].pageX;
            const y = e.type.includes('mouse') ? e.pageY : e.touches[0].pageY;
            rotY += (x - startX) * 0.5;
            rotX -= (y - startY) * 0.2;
            rotX = Math.max(-30, Math.min(30, rotX));
            startX = x; startY = y;
            card3d.style.transform = `rotateY(${rotY}deg) rotateX(${rotX}deg)`;
        }

        function dragEnd() { isDragging = false; card3d.style.transition = "transform 0.6s ease-out"; }

        function closeCollection() { document.getElementById('collection-screen').style.display = "none"; }
        function closeResult() { document.getElementById('result-overlay').style.display = "none"; document.getElementById('card-box').classList.remove('active'); document.getElementById('detail').classList.remove('active'); }
        
        function enterCode() {
            const code = prompt("ç§˜å¯†ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ã­ğŸ¦„");
            if (code === "MIRUCORN777" && !usedCodes.includes(code)) {
                coins += 5; usedCodes.push(code);
                localStorage.setItem('usedCodes', JSON.stringify(usedCodes));
                updateUI(); alert("5æšè¿½åŠ ï¼");
            }
        }
        window.onload = updateUI;
    </script>
</body>
</html>
