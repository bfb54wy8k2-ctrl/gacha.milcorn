<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ãƒŸãƒ«ã‚³ãƒ¼ãƒ³ã‚¬ãƒãƒ£å ã„</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="images/icon2.png" type="image/png">
    <link rel="apple-touch-icon" href="images/icon2.png">

    <style>
        :root { --gold: #d4af37; --pink: #ffb6c1; --bg: #1a1a1a; --font: 'Zen Maru Gothic', sans-serif; }
        body { background: var(--bg); color: white; font-family: var(--font); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .title { margin-top: 20px; font-size: 1.2rem; color: var(--gold); text-align: center; font-weight: 700; text-shadow: 0 0 10px rgba(212, 175, 55, 0.5); }
        .title img { width: 30px; vertical-align: middle; margin-right: 8px; border-radius: 50%; border: 1px solid var(--gold); }
        .title span { display: block; font-size: 0.8rem; letter-spacing: 3px; opacity: 0.8; margin-top: 5px; }

        /* å›æ•°åˆ¶é™ã‚¨ãƒªã‚¢ */
        #limit-info { margin-top: 15px; text-align: center; color: var(--pink); font-size: 0.9rem; background: rgba(255,182,193,0.1); padding: 10px 20px; border-radius: 15px; border: 1px solid rgba(255,182,193,0.3); width: 85%; max-width: 300px; }
        #timer { color: #fff; font-weight: bold; font-family: monospace; display: block; margin-top: 5px; }
        #coin-message { color: #ffa0a0; font-size: 0.8rem; margin-top: 5px; display: none; }

        /* ã‚¬ãƒãƒ£æœ¬ä½“ */
        #gacha-container { position: relative; width: 320px; height: 380px; margin-top: 10px; }
        #gacha-machine { width: 100%; height: 100%; object-fit: contain; z-index: 10; position: relative; }
        #capsule { position: absolute; bottom: 60px; right: 40px; width: 60px; height: 60px; border-radius: 50%; transform: scale(0); z-index: 5; display: none; }

        .pop-out { animation: capsule-pop 1.5s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
        @keyframes capsule-pop {
            0% { transform: translate(0, 0) scale(0) rotate(0deg); opacity: 1; z-index: 5; }
            100% { transform: translate(-100px, -120px) scale(3) rotate(360deg); opacity: 1; z-index: 20; }
        }

        .btn { margin-top: 20px; padding: 18px 60px; background: linear-gradient(to bottom, #ffc0cb, #ff69b4); color: white; border: none; border-radius: 50px; font-weight: 700; font-size: 1.1rem; box-shadow: 0 6px 0 #db7093; cursor: pointer; }
        .btn:disabled { background: #666; box-shadow: 0 6px 0 #444; color: #ccc; cursor: not-allowed; }

        /* ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å›³é‘‘ãƒœã‚¿ãƒ³ */
        #collection-btn { position: fixed; right: 20px; bottom: 30px; width: 70px; height: 70px; background: var(--gold); border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0,0,0,0.5); z-index: 100; cursor: pointer; border: 2px solid white; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        #collection-btn span { font-size: 0.7rem; font-weight: bold; color: #1a1a1a; }

        /* å›³é‘‘ç”»é¢ */
        #collection-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1a1a1a; z-index: 300; display: none; flex-direction: column; }
        .col-header { padding: 20px; text-align: center; background: #2a2a2a; border-bottom: 2px solid var(--gold); }
        .col-grid { flex: 1; overflow-y: auto; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        
        /* ã‚«ãƒ¼ãƒ‰ã‚¹ãƒ­ãƒƒãƒˆï¼ˆè»½é‡åŒ–ï¼šç”»åƒãŒãªã„æ™‚ã¯ï¼Ÿã‚’è¡¨ç¤ºï¼‰ */
        .card-slot { 
            aspect-ratio: 2/3.5; background: radial-gradient(circle, #333, #222); 
            border-radius: 8px; overflow: hidden; position: relative; border: 1px solid #444;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; color: #555; font-weight: bold;
        }
        .card-slot.unlocked { border: 2px solid var(--gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }
        .card-slot img { width: 100%; height: 100%; object-fit: cover; }

        /* æ‹¡å¤§è¡¨ç¤º */
        #zoom-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 500; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .zoom-card { width: 85%; max-width: 300px; border-radius: 15px; border: 3px solid var(--gold); box-shadow: 0 0 30px var(--gold); }

        /* ã‚¬ãƒãƒ£çµæœ */
        #result-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 400; }
        .card-reveal { width: 220px; height: 370px; border: 3px solid var(--gold); border-radius: 15px; overflow: hidden; animation: card-up 0.8s forwards; }
        @keyframes card-up { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        #detail { width: 85%; max-width: 350px; background: #fefcf0; color: #333; padding: 20px; border-radius: 20px; margin-top: 20px; text-align: center; }

        @keyframes shake { 0% { transform: rotate(0); } 50% { transform: rotate(-2deg); } 100% { transform: rotate(0); } }
    </style>
</head>
<body>

    <div class="title">
        <img src="images/icon2.png" alt="icon">
        ãƒŸãƒ«ã‚³ãƒ¼ãƒ³ã®å†’é™ºã‚¿ãƒ­ãƒƒãƒˆã‚¬ãƒãƒ£<span>Pocket Premium Edition</span>
    </div>

    <div id="limit-info">
        <span id="limit-text"></span>
        <span id="timer"></span>
        <span id="coin-message">æ—©ãå¼•ããŸã„å ´åˆã¯ãƒŸãƒ«ã‚³ã‚¤ãƒ³ãŒå¿…è¦ã ã‚ˆğŸ¦„</span>
    </div>

    <div id="gacha-container">
        <img src="images/gacha.png" id="gacha-machine" alt="ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£">
        <div id="capsule"></div>
    </div>

    <button class="btn" id="play-btn" onclick="playGacha()">ã‚¬ãƒãƒ£ã‚’å›ã™</button>

    <div id="collection-btn" onclick="openCollection()">
        <span style="font-size:1.5rem;">ğŸ“–</span>
        <span>å›³é‘‘</span>
    </div>

    <div id="collection-screen">
        <div class="col-header">
            <h2 style="margin:0; color:var(--gold);">ã‚«ãƒ¼ãƒ‰å›³é‘‘</h2>
            <p id="stats" style="margin:5px 0; font-size:0.9rem;"></p>
            <button onclick="closeCollection()" style="background:var(--pink); border:none; padding:5px 15px; border-radius:20px; font-weight:bold;">æˆ»ã‚‹</button>
        </div>
        <div class="col-grid" id="col-grid"></div>
    </div>

    <div id="zoom-overlay" onclick="closeZoom()">
        <img id="zoom-img" class="zoom-card" src="">
        <p style="color:white; margin-top:20px; font-size:0.8rem;">ã‚¿ãƒƒãƒ—ã—ã¦æˆ»ã‚‹</p>
    </div>

    <div id="result-overlay" onclick="closeResult()">
        <div class="card-reveal" id="card-box"></div>
        <div id="detail">
            <h2 id="card-name" style="margin:0; font-size:1.1rem; color:#d44d7c;"></h2>
            <p id="card-desc" style="white-space:pre-wrap; font-size:0.9rem; margin-top:10px;"></p>
        </div>
    </div>

    <script>
        // --- è¨­å®šã‚¨ãƒªã‚¢ ---
        const MAX_PLAYS = 4; // 1æ—¥ã®æœ€å¤§å›æ•°
        
        const tarotData = [
            { name: "0. THE FOOL", desc: "ğŸ’« æ–°ã—ã„å†’é™ºã®ã¯ã˜ã¾ã‚Š\nãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹æ–¹ã‚’é¸ã‚“ã§å¤§æ­£è§£ã€‚", img: "images/0.png" },
            { name: "1. THE MAGICIAN", desc: "âœ¨ é¡˜ã„ãŒå‹•ãå‡ºã™ã‚¿ã‚¤ãƒŸãƒ³ã‚°\nã‚ãªãŸã®è¨€è‘‰ã‚„è¡Œå‹•ãŒã€ç¾å®Ÿã‚’å¤‰ãˆã¦ã„ãã‚ˆã€‚", img: "images/1.png" },
            { name: "2. THE HIGH PRIESTESS", desc: "ğŸŒ™ ç›´æ„Ÿã‚’ä¿¡ã˜ã¦ã€‚æ„Ÿè¦šãŒå½“ãŸã£ã¦ã‚‹ã‚ˆã€‚", img: "images/2.png" },
            { name: "3. THE EMPRESS", desc: "ğŸŒ· æ„›ã¨è±Šã‹ã•ã«åŒ…ã¾ã‚Œã‚‹æ™‚\nå—ã‘å–ã‚‹ã“ã¨ã‚’é æ…®ã—ãªã„ã§ã€‚", img: "images/3.png" },
            { name: "4. THE EMPEROR", desc: "ğŸ‘‘ å®‰å®šã¨å®‰å¿ƒãŒæ‰‹ã«å…¥ã‚‹\nã—ã£ã‹ã‚Šã—ãŸé¸æŠãŒã€æœªæ¥ã‚’å®ˆã‚‹ã‚ˆã€‚", img: "images/4.png" },
            { name: "5. THE HIEROPHANT", desc: "ğŸ“– å¤§åˆ‡ãªå­¦ã³ãŒã‚ã‚‹ã€‚èª°ã‹ã®è¨€è‘‰ãŒãƒ’ãƒ³ãƒˆã€‚", img: "images/5.png" },
            { name: "6. THE LOVERS", desc: "ğŸ’– å¿ƒãŒé¸ã¶ç­”ãˆãŒæ­£è§£ã€‚æœ¬éŸ³ã‚’å¤§äº‹ã«ã—ã¦ã€‚", img: "images/6.png" },
            { name: "7. THE CHARIOT", desc: "ğŸš€ ä¸€æ°—ã«å‰é€²ï¼å‹¢ã„ã«ä¹—ã£ã¦OKã€‚", img: "images/7.png" },
            { name: "8. STRENGTH", desc: "ğŸ•Š å„ªã—ã•ãŒæœ€å¤§ã®æ­¦å™¨ã€‚ç„¡ç†ã«å¼·ãŒã‚‰ãªãã¦OKã€‚", img: "images/8.png" },
            { name: "9. THE HERMIT", desc: "ğŸ”¦ ä¸€äººã®æ™‚é–“ãŒç­”ãˆã‚’ãã‚Œã‚‹ã‚ˆã€‚", img: "images/9.png" },
            { name: "10. WHEEL OF FORTUNE", desc: "ğŸ¡ é‹å‘½ãŒå‹•ã„ã¦ã‚‹ï¼ãƒãƒ£ãƒ³ã‚¹ã‚’ä¿¡ã˜ã¦ã€‚", img: "images/10.png" },
            { name: "11. JUSTICE", desc: "âš– æ­£ã—ã„é¸æŠãŒã§ãã‚‹æ™‚ã€‚èª å®Ÿã•ãŒéµã€‚", img: "images/11.png" },
            { name: "12. THE HANGED MAN", desc: "â³ ä»Šã¯å¾…ã¤ã“ã¨ã‚‚å¤§åˆ‡ã€‚è¦–ç‚¹ã‚’å¤‰ãˆã¦ã¿ã¦ã€‚", img: "images/12.png" },
            { name: "13. DEATH", desc: "ğŸŒ± çµ‚ã‚ã‚Šã¯å§‹ã¾ã‚Šã€‚æ‰‹æ”¾ã—ãŸå…ˆã«å¹¸ã›ãŒã‚ã‚‹ã€‚", img: "images/13.png" },
            { name: "14. TEMPERANCE", desc: "ğŸ’— å¿ƒã¨ç¾å®Ÿã®ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½ã€‚ç„¦ã‚‰ãšã«ã€‚", img: "images/14.png" },
            { name: "15. THE DEVIL", desc: "ğŸ”“ ä¸å®‰ã‚’æ‰‹æ”¾ã›ã‚‹ã‚ˆã€‚ã‚ãªãŸã¯è‡ªç”±ã ã€‚", img: "images/15.png" },
            { name: "16. THE TOWER", desc: "âš¡ çªç„¶ã®å¤‰åŒ–ã¯ã€ä¸å¿…è¦ãªã‚‚ã®ãŒå£Šã‚ŒãŸã‚µã‚¤ãƒ³ã€‚", img: "images/16.png" },
            { name: "17. THE STAR", desc: "ğŸŒŸ å¸Œæœ›ã¯æ®‹ã£ã¦ã‚‹ã€‚ä¿¡ã˜ã‚‹å¿ƒãŒæœªæ¥ã‚’ç…§ã‚‰ã™ã€‚", img: "images/17.png" },
            { name: "18. THE MOON", desc: "ğŸŒ« æ°—æŒã¡ãŒæºã‚Œã‚‹æ™‚ã€‚ä»Šã¯ç­”ãˆã‚’å‡ºã•ãªãã¦ã„ã„ã€‚", img: "images/18.png" },
            { name: "19. THE SUN", desc: "â˜€ æœ€é«˜ã«ãƒãƒƒãƒ”ãƒ¼ï¼ç¬‘é¡”ã§é‹æ°—ã‚¢ãƒƒãƒ—ã€‚", img: "images/19.png" },
            { name: "20. JUDGEMENT", desc: "ğŸº ç›®è¦šã‚ã®æ™‚ã€‚éå»ã‚’è¶…ãˆã¦æ–°ã—ã„è‡ªåˆ†ã¸ã€‚", img: "images/20.png" },
            { name: "21. THE WORLD", desc: "ğŸŒˆ å®Œæˆï¼ã“ã“ã¾ã§æœ¬å½“ã«ã‚ˆãé ‘å¼µã£ãŸã­ã€‚", img: "images/21.png" },
            { name: "WANDS ACE", desc: "ğŸ”¥ ã‚„ã‚‹æ°—ãŒèŠ½ç”Ÿãˆã‚‹ã‚¹ã‚¿ãƒ¼ãƒˆï¼", img: "images/22.png" },
            { name: "WANDS 2", desc: "ğŸŒˆ æœªæ¥ã®é¸æŠè‚¢ãŒåºƒãŒã£ã¦ã‚‹ã‚ˆã€‚", img: "images/23.png" },
            { name: "WANDS 3", desc: "ğŸš¢ é€²å±•ãŒã‚ã‚‹ã‚ˆã€‚æœŸå¾…ã—ã¦å¾…ã£ã¦ã¦ã€‚", img: "images/24.png" },
            { name: "WANDS 4", desc: "ğŸ¡ å®‰å¿ƒã§ãã‚‹å ´æ‰€ã§å¬‰ã—ã„ã“ã¨ãŒã€‚", img: "images/25.png" },
            { name: "WANDS 5", desc: "ğŸ’¥ ã¡ã‚‡ã£ã¨ã—ãŸç«¶äº‰ã€‚æ·±åˆ»ã˜ã‚ƒãªã„ã‚ˆã€‚", img: "images/26.png" },
            { name: "WANDS 6", desc: "ğŸ† é ‘å¼µã‚ŠãŒèªã‚ã‚‰ã‚Œã‚‹ï¼è‡ªä¿¡ã‚’æŒã£ã¦ã€‚", img: "images/27.png" },
            { name: "WANDS 7", desc: "ğŸ›¡ è‡ªåˆ†ã‚’å®ˆã£ã¦ã€‚ã‚ãªãŸã¯é–“é•ã£ã¦ãªã„ã€‚", img: "images/28.png" },
            { name: "WANDS 8", desc: "ğŸ’Œ æ€¥å±•é–‹ï¼é€²å±•ãŒæ—©ã„ã‚ˆã€‚", img: "images/29.png" },
            { name: "WANDS 9", desc: "ğŸ’ª ã‚ã¨å°‘ã—ã€‚è¸ã‚“å¼µã‚Šã©ã“ã‚ã€‚", img: "images/30.png" },
            { name: "WANDS 10", desc: "ğŸ’ æŠ±ãˆã™ãã‹ã‚‚ã€‚å°‘ã—æ‰‹æ”¾ã—ã¦ã€‚", img: "images/31.png" },
            { name: "WANDS PAGE", desc: "ğŸŒ± ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹ãŠçŸ¥ã‚‰ã›ã®äºˆæ„Ÿã€‚", img: "images/32.png" },
            { name: "WANDS KNIGHT", desc: "ğŸ”¥ è¡Œå‹•ãŒãƒãƒ£ãƒ³ã‚¹ã‚’å‘¼ã¶ï¼", img: "images/33.png" },
            { name: "WANDS QUEEN", desc: "ğŸ‘‘ ã‚ãªãŸã‚‰ã—ãè¼ã‘ã‚‹æ™‚ã€‚", img: "images/34.png" },
            { name: "WANDS KING", desc: "ğŸ¦ å ‚ã€…ã¨ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã¦ã€‚", img: "images/35.png" },
            { name: "CUPS ACE", desc: "ğŸ’– æ–°ã—ã„æ„›ã€å¿ƒã®ã¨ãã‚ãã€‚", img: "images/36.png" },
            { name: "CUPS 2", desc: "ğŸ’• æƒ³ã„ãŒé€šã˜åˆã†æœ€é«˜ã®æ™‚é–“ã€‚", img: "images/37.png" },
            { name: "CUPS 3", desc: "ğŸ‰ å–œã³ã‚’ã‚·ã‚§ã‚¢ã—ã‚ˆã†ã€‚", img: "images/38.png" },
            { name: "CUPS 4", desc: "ğŸ˜Œ åœæ»ä¸­ã€‚ç„¡ç†ã›ãšä¼‘ã‚‚ã†ã€‚", img: "images/39.png" },
            { name: "CUPS 5", desc: "ğŸ’§ è½ã¡è¾¼ã‚“ã§ã‚‚å¤§ä¸ˆå¤«ã€‚å¸Œæœ›ã¯ã‚ã‚‹ã€‚", img: "images/40.png" },
            { name: "CUPS 6", desc: "ğŸ§¸ æ‡ã‹ã—ã„äººã‚„ç‰©ã‹ã‚‰ã®ç™’ã‚„ã—ã€‚", img: "images/41.png" },
            { name: "CUPS 7", desc: "ğŸŒ« è¿·ã„ä¸­ã€‚ä»Šã¯æ±ºã‚ãªãã¦OKã€‚", img: "images/42.png" },
            { name: "CUPS 8", desc: "ğŸš¶â€â™€ï¸ æ¬¡ã®å¹¸ã›ã¸ã€‚æ—…ç«‹ã¡ã®æ™‚ã€‚", img: "images/43.png" },
            { name: "CUPS 9", desc: "ğŸ° é¡˜ã„ãŒå¶ã†ï¼æº€ãŸã•ã‚Œã‚‹ã‚ˆã€‚", img: "images/44.png" },
            { name: "CUPS 10", desc: "ğŸŒˆ å®¶æ—ã‚„ä»²é–“ã¨ã®æœ€é«˜ã®å¹¸ã›ã€‚", img: "images/45.png" },
            { name: "CUPS PAGE", desc: "ğŸ’Œ å„ªã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šãã‚ˆã€‚", img: "images/46.png" },
            { name: "CUPS KNIGHT", desc: "ğŸŒ¹ ãƒ­ãƒãƒ³ãƒãƒƒã‚¯ãªå±•é–‹ã®äºˆæ„Ÿã€‚", img: "images/47.png" },
            { name: "CUPS QUEEN", desc: "ğŸ«¶ æ·±ã„æ„›æƒ…ã§åŒ…ã¾ã‚Œã‚‹æ™‚ã€‚", img: "images/48.png" },
            { name: "CUPS KING", desc: "ğŸŒŠ æ„Ÿæƒ…ã‚’ç©ã‚„ã‹ã«ä¿ã¦ã‚‹ã‚ˆã€‚", img: "images/49.png" },
            { name: "SWORDS ACE", desc: "ğŸ’¡ ã¯ã£ãã‚Šç­”ãˆãŒå‡ºã‚‹æ™‚ã€‚", img: "images/50.png" },
            { name: "SWORDS 2", desc: "ğŸ™ˆ æ±ºæ–­ã‚’å¾…ã£ã¦ã„ã‚‹çŠ¶æ…‹ã€‚", img: "images/51.png" },
            { name: "SWORDS 3", desc: "ğŸ’” å‚·ã¤ã„ãŸå¿ƒã€‚ç™’ã‚„ã—ãŒå¿…è¦ã€‚", img: "images/52.png" },
            { name: "SWORDS 4", desc: "ğŸ˜´ ä»Šã¯ä¼‘æ¯ã€‚å‹•ã‹ãªã„ã§ã€‚", img: "images/53.png" },
            { name: "SWORDS 5", desc: "âš  è¡çªã«æ³¨æ„ã€‚æ·±å…¥ã‚Šç¦ç‰©ã€‚", img: "images/54.png" },
            { name: "SWORDS 6", desc: "ğŸš¤ çŠ¶æ³ãŒæ”¹å–„ã¸å‘ã‹ã†ã‚ˆã€‚", img: "images/55.png" },
            { name: "SWORDS 7", desc: "ğŸ¦Š éš ã—äº‹ã‚„æ²¹æ–­ã«æ°—ã‚’ã¤ã‘ã¦ã€‚", img: "images/56.png" },
            { name: "SWORDS 8", desc: "ğŸ•¸ ç¸›ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯æ€ã„è¾¼ã¿ã€‚", img: "images/57.png" },
            { name: "SWORDS 9", desc: "ğŸŒ™ è€ƒãˆã™ãã¦ä¸å®‰ãªå¤œã€‚", img: "images/58.png" },
            { name: "SWORDS 10", desc: "ğŸŒ… å¤œæ˜ã‘ã€‚ã“ã“ã‹ã‚‰å›å¾©ã™ã‚‹ã€‚", img: "images/59.png" },
            { name: "SWORDS PAGE", desc: "ğŸ‘€ ç”¨å¿ƒã—ã¤ã¤ãƒãƒ£ãƒ³ã‚¹ã‚’å¾…ã£ã¦ã€‚", img: "images/60.png" },
            { name: "SWORDS KNIGHT", desc: "ğŸ’¨ å‹¢ã„ã§çªãé€²ã‚€æ™‚ã€‚", img: "images/61.png" },
            { name: "SWORDS QUEEN", desc: "â„ å†·é™ã«ã€ç†çŸ¥çš„ã«åˆ¤æ–­ã‚’ã€‚", img: "images/62.png" },
            { name: "SWORDS KING", desc: "ğŸ§  æ­£ã—ã„ç­”ãˆã‚’å°ãå‡ºã›ã‚‹ã€‚", img: "images/63.png" },
            { name: "PENTACLES ACE", desc: "ğŸŒŸ å¹¸é‹ãªãƒãƒ£ãƒ³ã‚¹ã®å§‹ã¾ã‚Šã€‚", img: "images/64.png" },
            { name: "PENTACLES 2", desc: "ğŸ”„ æŸ”è»Ÿã«ãƒãƒ©ãƒ³ã‚¹ã‚’ã¨ã£ã¦ã€‚", img: "images/65.png" },
            { name: "PENTACLES 3", desc: "ğŸ¤ ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒæˆåŠŸã‚’å‘¼ã¶ã€‚", img: "images/66.png" },
            { name: "PENTACLES 4", desc: "ğŸ”’ å®‰å®šã¸ã®ã“ã ã‚ã‚Šã€‚å°‘ã—ç·©ã‚ã¦ã€‚", img: "images/67.png" },
            { name: "PENTACLES 5", desc: "â„ åŠ©ã‘ã‚’æ±‚ã‚ã¦OKãªæ™‚ã€‚", img: "images/68.png" },
            { name: "PENTACLES 6", desc: "ğŸ è±Šã‹ã•ã‚’åˆ†ã‹ã¡åˆã†æ™‚ã€‚", img: "images/69.png" },
            { name: "PENTACLES 7", desc: "ğŸŒ³ åç©«ã‚’å¾…ã¤ã€å†è€ƒã®æ™‚é–“ã€‚", img: "images/70.png" },
            { name: "PENTACLES 8", desc: "ğŸ“š ã‚³ãƒ„ã‚³ãƒ„ã¨è…•ã‚’ç£¨ã“ã†ã€‚", img: "images/71.png" },
            { name: "PENTACLES 9", desc: "ğŸ’ ç£¨ã„ãŸå®ŸåŠ›ãŒé–‹èŠ±ã™ã‚‹ã€‚", img: "images/72.png" },
            { name: "PENTACLES 10", desc: "ğŸ° æ°¸ç¶šçš„ãªè±Šã‹ã•ã¨å®‰å¿ƒæ„Ÿã€‚", img: "images/73.png" },
            { name: "PENTACLES PAGE", desc: "ğŸŒ± å­¦ã³ã¨èª å®Ÿã•ãŒéµã€‚", img: "images/74.png" },
            { name: "PENTACLES KNIGHT", desc: "ğŸ¢ ç¢ºå®Ÿãªæ­©ã¿ã§æˆåŠŸã¸ã€‚", img: "images/75.png" },
            { name: "PENTACLES QUEEN", desc: "ğŸŒ¸ å„ªã—ãè‚²ã‚€å¿ƒã®ä½™è£•ã€‚", img: "images/76.png" },
            { name: "PENTACLES KING", desc: "ğŸ‘‘ ç¯‰ãä¸Šã’ãŸå¤§ããªæˆåŠŸã€‚", img: "images/77.png" },
            { name: "ğŸ¦„ ULTIMATE", desc: "ç©¶æ¥µã®ã‹ãŸã¡ã¸ã€‚ãŠã‚ã§ã¨ã†ï¼", img: "images/78.png" }
        ];

        let playCount = 0;
        let myCollection = JSON.parse(localStorage.getItem('myCollection') || '[]');

        function updateLimitUI() {
            const now = new Date();
            const lastDate = localStorage.getItem('lastPlayDate');
            const todayStr = now.toLocaleDateString();

            if (lastDate !== todayStr) {
                playCount = 0;
                localStorage.setItem('playCount', 0);
                localStorage.setItem('lastPlayDate', todayStr);
            } else {
                playCount = parseInt(localStorage.getItem('playCount') || 0);
            }

            const btn = document.getElementById('play-btn');
            const timerElement = document.getElementById('timer');
            const coinMsg = document.getElementById('coin-message');
            const limitText = document.getElementById('limit-text');

            if (playCount >= MAX_PLAYS) {
                btn.disabled = true;
                limitText.innerText = "æœ¬æ—¥ã®å ã„ã¯çµ‚äº†ã—ãŸã‚ˆğŸŒ™";
                coinMsg.style.display = "block";
                startTimer();
            } else {
                btn.disabled = false;
                limitText.innerText = `1æ—¥${MAX_PLAYS}å›ã¾ã§å¼•ã‘ã‚‹ã‚ˆğŸ¦„âœ¨ (ã‚ã¨${MAX_PLAYS - playCount}å›)`;
                timerElement.innerText = "";
                coinMsg.style.display = "none";
            }
        }

        function startTimer() {
            function updateTimer() {
                const now = new Date();
                const nextReset = new Date();
                nextReset.setHours(24, 0, 0, 0);
                const diff = nextReset - now;
                if (diff <= 0) { updateLimitUI(); return; }
                const h = Math.floor(diff / 1000 / 60 / 60);
                const m = Math.floor(diff / 1000 / 60) % 60;
                const s = Math.floor(diff / 1000) % 60;
                document.getElementById('timer').innerText = `æ¬¡å›ã¾ã§ï¼š${h}æ™‚é–“${m}åˆ†${s}ç§’`;
            }
            updateTimer();
            setInterval(updateTimer, 1000);
        }

        function playGacha() {
            if (playCount >= MAX_PLAYS) return;
            const btn = document.getElementById('play-btn');
            const capsule = document.getElementById('capsule');
            const machine = document.getElementById('gacha-machine');
            
            btn.disabled = true;
            playCount++;
            localStorage.setItem('playCount', playCount);

            const ballColors = ['#ff9999', '#99ccff', '#ffff99', '#cc99ff', '#99ff99'];
            capsule.style.background = ballColors[Math.floor(Math.random() * 5)];
            machine.style.animation = "shake 0.1s infinite";
            
            setTimeout(() => { machine.style.animation = "none"; }, 800);
            setTimeout(() => { capsule.style.display = "block"; capsule.classList.add('pop-out'); }, 600);
            setTimeout(() => { showResult(); updateLimitUI(); }, 2100);
        }

        function showResult() {
            const cardId = Math.floor(Math.random() * tarotData.length);
            const result = tarotData[cardId];
            
            if (!myCollection.includes(cardId)) {
                myCollection.push(cardId);
                localStorage.setItem('myCollection', JSON.stringify(myCollection));
            }

            const overlay = document.getElementById('result-overlay');
            const cardBox = document.getElementById('card-box');
            cardBox.innerHTML = `<img src="${result.img}" style="width:100%; height:100%; object-fit:cover;">`;
            document.getElementById('card-name').innerText = result.name;
            document.getElementById('card-desc').innerText = result.desc;
            overlay.style.display = "flex";
        }

        function closeResult() {
            document.getElementById('result-overlay').style.display = "none";
            const capsule = document.getElementById('capsule');
            capsule.style.display = "none";
            capsule.classList.remove('pop-out');
        }

        // --- å›³é‘‘ï¼ˆè»½é‡ç‰ˆãƒ­ã‚¸ãƒƒã‚¯ï¼‰ ---
        function openCollection() {
            const grid = document.getElementById('col-grid');
            grid.innerHTML = "";
            
            tarotData.forEach((card, index) => {
                const slot = document.createElement('div');
                const isUnlocked = myCollection.includes(index);
                slot.className = `card-slot ${isUnlocked ? 'unlocked' : ''}`;
                
                if (isUnlocked) {
                    // è§£æ”¾æ¸ˆã¿ï¼šç”»åƒã‚ã‚Š
                    slot.innerHTML = `<img src="${card.img}">`;
                    slot.onclick = () => zoomCard(card.img);
                } else {
                    // æœªè§£æ”¾ï¼šï¼Ÿã®ã¿ï¼ˆç”»åƒã¯èª­ã¿è¾¼ã¾ãªã„ï¼‰
                    slot.innerText = "?";
                }
                
                grid.appendChild(slot);
            });

            document.getElementById('stats').innerText = `å–å¾—æ•°: ${myCollection.length} / ${tarotData.length}`;
            document.getElementById('collection-screen').style.display = "flex";
        }

        function zoomCard(imgSrc) {
            const zoomOverlay = document.getElementById('zoom-overlay');
            const zoomImg = document.getElementById('zoom-img');
            zoomImg.src = imgSrc;
            zoomOverlay.style.display = "flex";
        }

        function closeZoom() {
            document.getElementById('zoom-overlay').style.display = "none";
        }

        function closeCollection() {
            document.getElementById('collection-screen').style.display = "none";
        }

        window.onload = updateLimitUI;
    </script>
</body>
</html>
